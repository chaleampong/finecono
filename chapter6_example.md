Introduction to Financial Econometrics บทที่ 7
================
เฉลิมพงษ์ คงเจริญ

# ตัวอย่างที่ 6.1 สหสัมพันธ์ไขว้ระหว่างอัตราผลตอบแทนรายสัปดาห์ของตลาดหลักทรัพย์ไทยและมาเลเซีย

ข้อมูลรายสัปดาห์ระหว่ามผลได้ตอบแทนของการลงทุนในตลาดหลักทรัพย์ไทยและมาเลเซีย
ระหว่างวันที่ 2 ม.ค. 2541 ถึง 31 ธันวาคม 2562
โดยสร้างเมตริกซ์ที่มีสองตัวแปร lret_thmy

``` r
lret3 <- read.csv("https://raw.githubusercontent.com/chaleampong/finecono/main/lret_3countries_w9819.txt")
head(lret3)
```

    ##        Index       SET     StTimes       KLSE
    ## 1 1998-01-02  4.264711  -3.6890706   1.941946
    ## 2 1998-01-09 -6.375712 -24.2061047 -15.140368
    ## 3 1998-01-16  9.107125   6.1415567   9.384820
    ## 4 1998-01-23  9.900370   1.4332348   3.386636
    ## 5 1998-01-30 15.795750   0.5674343   1.939640
    ## 6 1998-02-06  7.907455  15.5472723  24.578566

``` r
lret_thmy<-cbind(lret3$SET, lret3$KLSE)
colnames(lret_thmy)<-c("TH", "MY")
rownames(lret_thmy)<-lret3$Index
lret_thmy<-data.frame(lret_thmy)
head(lret_thmy)
```

    ##                   TH         MY
    ## 1998-01-02  4.264711   1.941946
    ## 1998-01-09 -6.375712 -15.140368
    ## 1998-01-16  9.107125   9.384820
    ## 1998-01-23  9.900370   3.386636
    ## 1998-01-30 15.795750   1.939640
    ## 1998-02-06  7.907455  24.578566

``` r
plot.ts(lret_thmy$TH)
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->

``` r
plot.ts(lret_thmy$MY)
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-1-2.png)<!-- -->

## หา cross correlation

เราใช้คำสั่ง ccf

``` r
ccf(lret_thmy$TH, lret_thmy$MY, type=c("correlation"), lag.max=10, plot=FALSE)
```

    ## 
    ## Autocorrelations of series 'X', by lag
    ## 
    ##    -10     -9     -8     -7     -6     -5     -4     -3     -2     -1      0 
    ##  0.038  0.109  0.093  0.050  0.063  0.035  0.033  0.094  0.139  0.126  0.409 
    ##      1      2      3      4      5      6      7      8      9     10 
    ##  0.031  0.127  0.047  0.025  0.097 -0.047 -0.004 -0.035 -0.005 -0.064

``` r
ccf(lret_thmy$TH, lret_thmy$MY, type=c("correlation"), lag.max=10, ylab="cross-correlation", main="")
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

# ตัวอย่างที่ 6.2 การทดสอบพอรทแมนโทกรณีตัวแปรพหุ

เราใช้คำสั่ง mq จาก Package *MTS*

``` r
library(MTS)
mq(lret_thmy, lag=10, adj=0)
```

    ## Ljung-Box Statistics:  
    ##         m       Q(m)     df    p-value
    ##  [1,]   1.0      20.4     4.0        0
    ##  [2,]   2.0      65.4     8.0        0
    ##  [3,]   3.0      79.2    12.0        0
    ##  [4,]   4.0     102.2    16.0        0
    ##  [5,]   5.0     114.6    20.0        0
    ##  [6,]   6.0     125.6    24.0        0
    ##  [7,]   7.0     135.5    28.0        0
    ##  [8,]   8.0     151.6    32.0        0
    ##  [9,]   9.0     168.3    36.0        0
    ## [10,]  10.0     176.5    40.0        0

![](chapter6_example_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

# ตัวอย่างที่ 6.5 การสร้างแบบจำลอง VAR สำหรับผลตอบแทนรายสัปดาห์ของตลาดหลักทรัพย์ไทยและมาเลเซีย

ต่อเนื่องจากตัวอย่างที่ 6.1

``` r
library(vars)
msel_aic<-VAR(lret_thmy, lag.max=5, ic=c("AIC"))
msel_aic
```

    ## 
    ## VAR Estimation Results:
    ## ======================= 
    ## 
    ## Estimated coefficients for equation TH: 
    ## ======================================= 
    ## Call:
    ## TH = TH.l1 + MY.l1 + TH.l2 + MY.l2 + TH.l3 + MY.l3 + TH.l4 + MY.l4 + const 
    ## 
    ##        TH.l1        MY.l1        TH.l2        MY.l2        TH.l3        MY.l3 
    ##  0.015239105  0.009036918  0.134833957  0.122681565  0.040398752  0.042392906 
    ##        TH.l4        MY.l4        const 
    ## -0.131862231  0.059224663  0.084773031 
    ## 
    ## 
    ## Estimated coefficients for equation MY: 
    ## ======================================= 
    ## Call:
    ## MY = TH.l1 + MY.l1 + TH.l2 + MY.l2 + TH.l3 + MY.l3 + TH.l4 + MY.l4 + const 
    ## 
    ##       TH.l1       MY.l1       TH.l2       MY.l2       TH.l3       MY.l3 
    ##  0.10029253 -0.02484880  0.08226038  0.08473980  0.03719198  0.03544573 
    ##       TH.l4       MY.l4       const 
    ##  0.01608982 -0.07212360  0.05827844

``` r
msel_bic<-VAR(lret_thmy, lag.max=5, ic=c("SC"))
msel_bic
```

    ## 
    ## VAR Estimation Results:
    ## ======================= 
    ## 
    ## Estimated coefficients for equation TH: 
    ## ======================================= 
    ## Call:
    ## TH = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##      TH.l1      MY.l1      TH.l2      MY.l2      const 
    ## 0.02474845 0.00509818 0.12725151 0.09504302 0.10272112 
    ## 
    ## 
    ## Estimated coefficients for equation MY: 
    ## ======================================= 
    ## Call:
    ## MY = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##       TH.l1       MY.l1       TH.l2       MY.l2       const 
    ##  0.11020322 -0.03607654  0.08327081  0.07860800  0.07366975

``` r
summary(msel_bic)
```

    ## 
    ## VAR Estimation Results:
    ## ========================= 
    ## Endogenous variables: TH, MY 
    ## Deterministic variables: const 
    ## Sample size: 1147 
    ## Log Likelihood: -5497.069 
    ## Roots of the characteristic polynomial:
    ## 0.4705 0.4076 0.1479 0.07366
    ## Call:
    ## VAR(y = lret_thmy, lag.max = 5, ic = c("SC"))
    ## 
    ## 
    ## Estimation results for equation TH: 
    ## =================================== 
    ## TH = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##       Estimate Std. Error t value Pr(>|t|)    
    ## TH.l1 0.024748   0.031896   0.776   0.4380    
    ## MY.l1 0.005098   0.041329   0.123   0.9018    
    ## TH.l2 0.127252   0.032117   3.962 7.89e-05 ***
    ## MY.l2 0.095043   0.041016   2.317   0.0207 *  
    ## const 0.102721   0.094078   1.092   0.2751    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## 
    ## Residual standard error: 3.18 on 1142 degrees of freedom
    ## Multiple R-Squared: 0.03066, Adjusted R-squared: 0.02726 
    ## F-statistic:  9.03 on 4 and 1142 DF,  p-value: 3.511e-07 
    ## 
    ## 
    ## Estimation results for equation MY: 
    ## =================================== 
    ## MY = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##       Estimate Std. Error t value Pr(>|t|)    
    ## TH.l1  0.11020    0.02428   4.538 6.27e-06 ***
    ## MY.l1 -0.03608    0.03146  -1.147 0.251790    
    ## TH.l2  0.08327    0.02445   3.406 0.000683 ***
    ## MY.l2  0.07861    0.03123   2.517 0.011958 *  
    ## const  0.07367    0.07162   1.029 0.303892    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## 
    ## Residual standard error: 2.421 on 1142 degrees of freedom
    ## Multiple R-Squared: 0.04361, Adjusted R-squared: 0.04026 
    ## F-statistic: 13.02 on 4 and 1142 DF,  p-value: 2.265e-10 
    ## 
    ## 
    ## 
    ## Covariance matrix of residuals:
    ##        TH    MY
    ## TH 10.113 2.996
    ## MY  2.996 5.862
    ## 
    ## Correlation matrix of residuals:
    ##        TH     MY
    ## TH 1.0000 0.3891
    ## MY 0.3891 1.0000

กรณีใช้ AIC จะเลือกแบบจำลอง VAR(4) ในขณะที่ BIC จะเลือกแบบจำลอง
VAR(2)ในการวิเคราะห์ต่อไปเราจะใช้แบบจำลอง VAR(2) และตั้งชื่อว่า *model1*

``` r
model1<-VAR(lret_thmy, p=2)
summary(model1)
```

    ## 
    ## VAR Estimation Results:
    ## ========================= 
    ## Endogenous variables: TH, MY 
    ## Deterministic variables: const 
    ## Sample size: 1147 
    ## Log Likelihood: -5497.069 
    ## Roots of the characteristic polynomial:
    ## 0.4705 0.4076 0.1479 0.07366
    ## Call:
    ## VAR(y = lret_thmy, p = 2)
    ## 
    ## 
    ## Estimation results for equation TH: 
    ## =================================== 
    ## TH = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##       Estimate Std. Error t value Pr(>|t|)    
    ## TH.l1 0.024748   0.031896   0.776   0.4380    
    ## MY.l1 0.005098   0.041329   0.123   0.9018    
    ## TH.l2 0.127252   0.032117   3.962 7.89e-05 ***
    ## MY.l2 0.095043   0.041016   2.317   0.0207 *  
    ## const 0.102721   0.094078   1.092   0.2751    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## 
    ## Residual standard error: 3.18 on 1142 degrees of freedom
    ## Multiple R-Squared: 0.03066, Adjusted R-squared: 0.02726 
    ## F-statistic:  9.03 on 4 and 1142 DF,  p-value: 3.511e-07 
    ## 
    ## 
    ## Estimation results for equation MY: 
    ## =================================== 
    ## MY = TH.l1 + MY.l1 + TH.l2 + MY.l2 + const 
    ## 
    ##       Estimate Std. Error t value Pr(>|t|)    
    ## TH.l1  0.11020    0.02428   4.538 6.27e-06 ***
    ## MY.l1 -0.03608    0.03146  -1.147 0.251790    
    ## TH.l2  0.08327    0.02445   3.406 0.000683 ***
    ## MY.l2  0.07861    0.03123   2.517 0.011958 *  
    ## const  0.07367    0.07162   1.029 0.303892    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## 
    ## Residual standard error: 2.421 on 1142 degrees of freedom
    ## Multiple R-Squared: 0.04361, Adjusted R-squared: 0.04026 
    ## F-statistic: 13.02 on 4 and 1142 DF,  p-value: 2.265e-10 
    ## 
    ## 
    ## 
    ## Covariance matrix of residuals:
    ##        TH    MY
    ## TH 10.113 2.996
    ## MY  2.996 5.862
    ## 
    ## Correlation matrix of residuals:
    ##        TH     MY
    ## TH 1.0000 0.3891
    ## MY 0.3891 1.0000

# ตัวอย่างที่ 6.6 การพยากรณ์จากแบบจำลอง VAR

เราสามารถพยากรณ์ได้โดยใช้คำสั่ง *predict*

``` r
model1.pred<-predict(model1, n.ahead=5)
model1.pred
```

    ## $TH
    ##              fcst     lower    upper       CI
    ## [1,]  0.143639986 -6.089333 6.376613 6.232973
    ## [2,] -0.009651427 -6.244813 6.225510 6.235161
    ## [3,]  0.136304493 -6.188402 6.461011 6.324707
    ## [4,]  0.103915840 -6.221701 6.429532 6.325617
    ## [5,]  0.132379573 -6.196688 6.461447 6.329068
    ## 
    ## $MY
    ##             fcst     lower    upper       CI
    ## [1,]  0.16436363 -4.580829 4.909557 4.745193
    ## [2,] -0.01525905 -4.803419 4.772901 4.788160
    ## [3,]  0.09803794 -4.748154 4.944230 4.846192
    ## [4,]  0.08315091 -4.765296 4.931598 4.848447
    ## [5,]  0.10117857 -4.749669 4.952026 4.850847

# ตัวอย่างที่ 6.7 การทดสอบ Granger Causality

เราสามารถทดสอบ Granger Causality ได้ด้วยคำสั่ง *causality*
โดยระบุแบบจำลองและตัวแปรที่เป็น cause

``` r
causality(model1, cause="TH")
```

    ## $Granger
    ## 
    ##  Granger causality H0: TH do not Granger-cause MY
    ## 
    ## data:  VAR object model1
    ## F-Test = 15.587, df1 = 2, df2 = 2284, p-value = 1.889e-07
    ## 
    ## 
    ## $Instant
    ## 
    ##  H0: No instantaneous causality between: TH and MY
    ## 
    ## data:  VAR object model1
    ## Chi-squared = 150.82, df = 1, p-value < 2.2e-16

``` r
causality(model1, cause="MY")
```

    ## $Granger
    ## 
    ##  Granger causality H0: MY do not Granger-cause TH
    ## 
    ## data:  VAR object model1
    ## F-Test = 2.6861, df1 = 2, df2 = 2284, p-value = 0.06836
    ## 
    ## 
    ## $Instant
    ## 
    ##  H0: No instantaneous causality between: MY and TH
    ## 
    ## data:  VAR object model1
    ## Chi-squared = 150.82, df = 1, p-value < 2.2e-16

# ตัวอย่างที่ 6.8 การสร้าง Impulse response function

เราสามารถสร้าง Impulse reponse function ได้ด้วยคำสั่ง *irf*
โดยระบุแบบจำลองที่ใช้ รูปแบบของ IRF กรณีลดรูป (ortho=FALSE)
หรือกรณีโครงสร้าง (ortho=TRUE) และวธีการในการคำนวณช่วงความเชื่อมั่น
(Boot=TRUE)

``` r
model1.irf<-irf(model1, n.ahead=10)
model1.irf
```

    ## 
    ## Impulse response coefficients
    ## $TH
    ##                 TH           MY
    ##  [1,] 3.1801467727 0.9420169559
    ##  [2,] 0.0835062856 0.3164777138
    ##  [3,] 0.4978907192 0.3366487105
    ##  [4,] 0.0547436185 0.0745553581
    ##  [5,] 0.0970883707 0.0712662693
    ##  [6,] 0.0168182895 0.0185476041
    ##  [7,] 0.0196387885 0.0148710225
    ##  [8,] 0.0044648178 0.0044862254
    ##  [9,] 0.0040458212 0.0031345090
    ## [10,] 0.0011106473 0.0010572225
    ## [11,] 0.0008456268 0.0006675523
    ## 
    ## $MY
    ##                  TH            MY
    ##  [1,]  0.000000e+00  2.2302784186
    ##  [2,]  1.137036e-02 -0.0804607195
    ##  [3,]  2.118436e-01  0.1794735161
    ##  [4,] -4.254449e-05  0.0114930261
    ##  [5,]  4.407266e-02  0.0313291239
    ##  [6,]  2.337370e-03  0.0046266040
    ##  [7,]  8.667361e-03  0.0062233598
    ##  [8,]  9.833918e-04  0.0012889766
    ##  [9,]  1.725330e-03  0.0012728151
    ## [10,]  2.968346e-04  0.0003274299
    ## [11,]  3.495386e-04  0.0002646227
    ## 
    ## 
    ## Lower Band, CI= 0.95 
    ## $TH
    ##                  TH           MY
    ##  [1,]  2.887050e+00 0.7428200410
    ##  [2,] -1.167724e-01 0.1809129421
    ##  [3,]  3.127888e-01 0.1963250797
    ##  [4,] -1.279390e-02 0.0333167721
    ##  [5,]  4.350636e-02 0.0301540299
    ##  [6,] -1.355541e-03 0.0060183233
    ##  [7,]  6.341070e-03 0.0048261655
    ##  [8,] -1.501356e-04 0.0010257287
    ##  [9,]  9.888229e-04 0.0007634184
    ## [10,]  1.100055e-05 0.0001580899
    ## [11,]  1.464849e-04 0.0001146962
    ## 
    ## $MY
    ##                  TH            MY
    ##  [1,]  0.000000e+00  1.983325e+00
    ##  [2,] -1.547319e-01 -1.990415e-01
    ##  [3,]  3.372951e-02  4.472764e-02
    ##  [4,] -4.044762e-02 -1.939305e-02
    ##  [5,]  7.332044e-03  8.242787e-03
    ##  [6,] -5.767873e-03 -2.707129e-03
    ##  [7,]  1.117281e-03  9.391787e-04
    ##  [8,] -1.029980e-03 -2.960825e-04
    ##  [9,]  1.634510e-04  1.252221e-04
    ## [10,] -1.913894e-04 -3.393113e-05
    ## [11,]  2.376209e-05  1.798106e-05
    ## 
    ## 
    ## Upper Band, CI= 0.95 
    ## $TH
    ##                TH          MY
    ##  [1,] 3.421679751 1.109918617
    ##  [2,] 0.254145651 0.476384144
    ##  [3,] 0.700817563 0.453041110
    ##  [4,] 0.123249213 0.123079585
    ##  [5,] 0.169631252 0.110487583
    ##  [6,] 0.041413167 0.035248948
    ##  [7,] 0.040983356 0.028545401
    ##  [8,] 0.012412325 0.010331274
    ##  [9,] 0.010341002 0.007514840
    ## [10,] 0.003701304 0.003064778
    ## [11,] 0.002660066 0.001973835
    ## 
    ## $MY
    ##                TH           MY
    ##  [1,] 0.000000000 2.4457654213
    ##  [2,] 0.187444482 0.0551994719
    ##  [3,] 0.363083092 0.3019952388
    ##  [4,] 0.042948210 0.0412601639
    ##  [5,] 0.080717695 0.0586449351
    ##  [6,] 0.013456648 0.0125531211
    ##  [7,] 0.018581115 0.0125535924
    ##  [8,] 0.004343304 0.0039093622
    ##  [9,] 0.004244955 0.0030902822
    ## [10,] 0.001342820 0.0011201548
    ## [11,] 0.001054327 0.0007836862

``` r
plot(model1.irf)
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->![](chapter6_example_files/figure-gfm/unnamed-chunk-8-2.png)<!-- -->

``` r
# reduced form
model1.irfr<-irf(model1, n.ahead=10, ortho=FALSE)
model1.irfr
```

    ## 
    ## Impulse response coefficients
    ## $TH
    ##                 TH           MY
    ##  [1,] 1.0000000000 0.0000000000
    ##  [2,] 0.0247484531 0.1102032225
    ##  [3,] 0.1284258303 0.0820224199
    ##  [4,] 0.0172198305 0.0219175340
    ##  [5,] 0.0246759426 0.0182487134
    ##  [6,] 0.0049780846 0.0052178207
    ##  [7,] 0.0050242650 0.0038496406
    ##  [8,] 0.0012733551 0.0012395001
    ##  [9,] 0.0010430595 0.0008165981
    ## [10,] 0.0003098195 0.0002889564
    ## [11,] 0.0002194836 0.0001747661
    ## 
    ## $MY
    ##                  TH            MY
    ##  [1,]  0.000000e+00  1.0000000000
    ##  [2,]  5.098180e-03 -0.0360765359
    ##  [3,]  9.498526e-02  0.0804713504
    ##  [4,] -1.907586e-05  0.0051531800
    ##  [5,]  1.976106e-02  0.0140471807
    ##  [6,]  1.048017e-03  0.0020744513
    ##  [7,]  3.886224e-03  0.0027903959
    ##  [8,]  4.409278e-04  0.0005779442
    ##  [9,]  7.735942e-04  0.0005706979
    ## [10,]  1.330931e-04  0.0001468112
    ## [11,]  1.567242e-04  0.0001186501
    ## 
    ## 
    ## Lower Band, CI= 0.95 
    ## $TH
    ##                  TH           MY
    ##  [1,]  1.000000e+00 0.000000e+00
    ##  [2,] -4.669115e-02 6.397584e-02
    ##  [3,]  6.150437e-02 2.923898e-02
    ##  [4,] -1.249098e-03 7.052202e-03
    ##  [5,]  8.665750e-03 6.906315e-03
    ##  [6,]  1.808112e-05 1.518056e-03
    ##  [7,]  1.287524e-03 1.202697e-03
    ##  [8,]  2.634179e-05 2.503684e-04
    ##  [9,]  2.275301e-04 2.096153e-04
    ## [10,]  1.220973e-05 4.054364e-05
    ## [11,]  4.081716e-05 3.376487e-05
    ## 
    ## $MY
    ##                  TH            MY
    ##  [1,]  0.000000e+00  1.000000e+00
    ##  [2,] -6.437254e-02 -9.611493e-02
    ##  [3,]  2.272787e-02  2.686227e-02
    ##  [4,] -1.732286e-02 -7.042241e-03
    ##  [5,]  6.680424e-03  4.720536e-03
    ##  [6,] -3.074261e-03 -6.583531e-04
    ##  [7,]  1.148085e-03  7.263783e-04
    ##  [8,] -5.487822e-04 -8.616628e-05
    ##  [9,]  1.824928e-04  1.077714e-04
    ## [10,] -9.479227e-05 -1.256543e-05
    ## [11,]  2.886464e-05  1.670216e-05
    ## 
    ## 
    ## Upper Band, CI= 0.95 
    ## $TH
    ##                 TH           MY
    ##  [1,] 1.0000000000 0.0000000000
    ##  [2,] 0.0857445339 0.1650977700
    ##  [3,] 0.1913265175 0.1342045548
    ##  [4,] 0.0387131076 0.0386446242
    ##  [5,] 0.0442131696 0.0353408281
    ##  [6,] 0.0124383729 0.0116306130
    ##  [7,] 0.0112854756 0.0098797446
    ##  [8,] 0.0040357732 0.0034526324
    ##  [9,] 0.0031939439 0.0027661496
    ## [10,] 0.0013202104 0.0010444746
    ## [11,] 0.0008926288 0.0007806838
    ## 
    ## $MY
    ##                 TH           MY
    ##  [1,] 0.0000000000 1.0000000000
    ##  [2,] 0.0680778610 0.0160322160
    ##  [3,] 0.1945790795 0.1329900360
    ##  [4,] 0.0135620561 0.0193290977
    ##  [5,] 0.0405378021 0.0276253622
    ##  [6,] 0.0076863554 0.0068096479
    ##  [7,] 0.0099953345 0.0070241911
    ##  [8,] 0.0028236333 0.0022949254
    ##  [9,] 0.0025205294 0.0018907288
    ## [10,] 0.0009417489 0.0007346217
    ## [11,] 0.0006750668 0.0005162913

``` r
plot(model1.irfr)
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-8-3.png)<!-- -->![](chapter6_example_files/figure-gfm/unnamed-chunk-8-4.png)<!-- -->
## พิจารณากรณีการเรียงตัวแปรใหม่

``` r
lret_myth<-cbind( lret3$KLSE, lret3$SET)
colnames(lret_myth)<-c("MY","TH")
rownames(lret_myth)<-lret3$Index
model2<-VAR(lret_myth,p=2)
model2.irf<-irf(model2, n.ahead=10)
plot(model2.irf)
```

![](chapter6_example_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->![](chapter6_example_files/figure-gfm/unnamed-chunk-9-2.png)<!-- -->

ตัวแปรทั้งสองยังมีความสัมพันธ์เชิงบวก

# ตัวอย่างที่ 6.9 การแยกความแปรปรวนของค่าคลาดเคลื่อนการพยากรณ์

เราสามารถแยกความแปรปรวนของค่าผิดพลาดได้ด้วยคำสั่ง *fevd*

``` r
fevd(model1, n.ahead=10)
```

    ## $TH
    ##              TH           MY
    ##  [1,] 1.0000000 0.000000e+00
    ##  [2,] 0.9999872 1.277466e-05
    ##  [3,] 0.9956779 4.322106e-03
    ##  [4,] 0.9956791 4.320862e-03
    ##  [5,] 0.9954976 4.502427e-03
    ##  [6,] 0.9954972 4.502826e-03
    ##  [7,] 0.9954902 4.509831e-03
    ##  [8,] 0.9954901 4.509915e-03
    ##  [9,] 0.9954898 4.510192e-03
    ## [10,] 0.9954898 4.510200e-03
    ## 
    ## $MY
    ##              TH        MY
    ##  [1,] 0.1513930 0.8486070
    ##  [2,] 0.1654702 0.8345298
    ##  [3,] 0.1800684 0.8199316
    ##  [4,] 0.1808093 0.8191907
    ##  [5,] 0.1814595 0.8185405
    ##  [6,] 0.1815049 0.8184951
    ##  [7,] 0.1815333 0.8184667
    ##  [8,] 0.1815359 0.8184641
    ##  [9,] 0.1815372 0.8184628
    ## [10,] 0.1815373 0.8184627
